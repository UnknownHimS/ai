<!DOCTYPE html>
<html>
<head>
  <title>Wikipedia Search with Birth Date Extraction</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #111; color: #0ff; }
    input { padding: 8px; width: 300px; border: none; border-radius: 4px; }
    button { padding: 8px 12px; cursor: pointer; background: #0ff; border: none; border-radius: 4px; color: #000; }
    button:hover { background: #0cc; }
    .result { margin-top: 20px; }
    .result-item { margin-bottom: 15px; }
    a { color: #0ff; text-decoration: none; }
    a:hover { text-decoration: underline; }
  </style>
</head>
<body>
  <h1>Wikipedia Search with Birth Date Extraction</h1>
  <input type="text" id="searchInput" placeholder="Enter search term" />
  <button onclick="searchWikipedia()">Search</button>

  <div id="results" class="result"></div>

  <script>
    function extractBirthInfo(text) {
      // Extract the first parentheses block
      const parenMatch = text.match(/\(([^)]+)\)/);
      if (!parenMatch) return null;

      const inside = parenMatch[1];

      // Check if inside contains "born" (case-insensitive)
      const bornMatch = inside.match(/born\s+([^)]+)/i);
      if (bornMatch) {
        // Return the born date info after "born"
        return bornMatch[1].trim();
      }

      // Otherwise, check if it looks like a date range or single date (e.g. 14 March 1879 – 18 April 1955)
      // Simple heuristic: contains digits and dash or just digits and month names
      const dateRangeRegex = /(\d{1,2}\s\w+\s\d{4})(\s*–\s*(\d{1,2}\s\w+\s\d{4}))?/;
      const dateRangeMatch = inside.match(dateRangeRegex);
      if (dateRangeMatch) {
        return dateRangeMatch[0]; // full matched date range or single date
      }

      // Otherwise, return the whole parentheses content as fallback (could be years or something)
      return inside;
    }

    async function searchWikipedia() {
      const queryRaw = document.getElementById('searchInput').value.trim();
      if (!queryRaw) {
        alert('Please enter a search term');
        return;
      }

      const query = queryRaw.toLowerCase();

      const resultsDiv = document.getElementById('results');
      resultsDiv.innerHTML = 'Loading...';

      // Wikipedia summary API endpoint
      const summaryUrl = `https://en.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(queryRaw)}`;

      try {
        const response = await fetch(summaryUrl);
        if (!response.ok) {
          resultsDiv.innerHTML = `No summary found for "${queryRaw}".`;
          return;
        }

        const data = await response.json();

        let extract = data.extract || "No summary available.";
        let displayText = extract;

        // If user asked about birth info ("born" or "when ... born")
        if (query.includes('born') || query.startsWith('when')) {
          const birthInfo = extractBirthInfo(extract);
          if (birthInfo) {
            displayText = `Birth info found: ${birthInfo}\n\nFull summary:\n${extract}`;
          }
        }

        // Display
        resultsDiv.innerHTML = `
          <div class="result-item">
            <a href="https://en.wikipedia.org/wiki/${encodeURIComponent(data.title)}" target="_blank" rel="noopener">${data.title}</a>
            <p style="white-space: pre-line;">${displayText}</p>
          </div>
        `;

      } catch (error) {
        resultsDiv.innerHTML = 'An error occurred while fetching data.';
        console.error(error);
      }
    }
  </script>
</body>
</html>
